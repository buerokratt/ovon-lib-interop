{
  "$id": "https://https://openvoicenetwork.org/schema/dialog-event.json",
  "$schema": "https://https://openvoicenetwork.org/schema",
  "description": "A representation of a 'language eventâ€™ that is to say any information associated with a phrase, utterance or part of an utterance.",
  "type": "object",
  "properties": {
    "id": {
      "type": "string"
    },
    "speaker-id": {
      "type": "string"
    },
    "span": { "$ref": "#/$defs/span" },
    "features": {
      "type": "object",
      "patternProperties": {
        ".*": { "$ref": "#/$defs/feature" }
      }
    }
  },
  "$defs": {
    "feature": {
      "type": "object",
      "oneOf": [
        { "required":  ["mime-type" , "tokens" ] },
        { "required":  ["mime-type" , "token-ref" ] }
      ],
      "properties": {
        "encoding": {
          "type": "string",
          "description": "The text encoding of the token values"
        },
        "mime-type": {
          "type": "string",
          "description": "The mime-type of the token values"
        },
        "lang": {
          "type": "string",
          "description": "The language of the token values"
        },
        "alphabet": {
          "type": "string",
          "description": "The specific subset of tokens allowed in this language"
        },
        "token-ref": { 
          "$ref": "#/$defs/uri"
        },
        "tokens" : {
          "type": "array",
          "items": { 
            "type": "array",
            "items": { 
              "$ref": "#/$defs/token" 
            }
          }
        }
      }
    },
    "token": {
      "type": "object",
      "properties": {
          "value": {
            "type": ["number","string","object","array","boolean"]
          },
          "confidence": {
            "type": "number"
          },
          "time-link": { "$ref": "#/$defs/span" },
          "token-link" : {
              "type": "object",
              "properties": {
                  "feature": {
                      "type": "string"
                  },
                  "tokens": {
                      "type" : "array",
                      "items": { 
                          "type": "integer"
                      }
                  }
              }
          }
      }
    },
    "uri": {
      "type": "string",
      "description": "any valid URI"
    },
    "span": {
      "properties": {
          "start": { 
              "$ref": "#/$defs/iso-time" 
          },
          "end": {
              "$ref": "#/$defs/iso-time" 
          }
      }
    },
    "iso-time": {        
      "description": "A string in ISO 8601 format."
    }
  }
}